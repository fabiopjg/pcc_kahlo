{% load crispy_forms_tags %}

{% block content %}


<a href="{% url 'post-list' %}">Voltar ao Feed</a>
				
<p>
    <a href="{% url 'perfil' post.autor.perfil.pk %}">
        <img class="foto_perfil" src="{{ post.autor.perfil.foto.url }}" />
    </a>
    <p><a style="text-decoration: none" href="{% url 'perfil' post.autor.perfil.pk %}"
        >@{{post.autor }} </a> {{ post.criado_em }} </p>

    {% if request.user == post.autor %}
        <a href="{% url 'post-edit' post.pk %}" style="color: #333;">Editar</a>
        <a href="{% url 'post-delete' post.pk %}" style="color: #333;">Deletar</a>
    {% endif %}
</p>
<p>{{ post.corpo }}</p>

<form method="POST" action="{% url 'like' post.pk %}">
    {% csrf_token %}
    <input type="hidden" name="next" value="{{ request.path }}">
    <button type="submit">Amei
        <span> {{ post.likes.all.count }} </span>
    </button>
</form>

<form method="POST">
    {% csrf_token %}
    {{ form | crispy }}

    <div class="d-grid gap-2 mt-3">
        <button class="btn btn-success">Postar!</button>
    </div>
</form>

{% for comentario in comentarios %}

<p>
    <a href="{% url 'perfil' comentario.autor.perfil.pk %}">
        <img class="foto_perfil" src="{{ comentario.autor.perfil.foto.url }}" />
    </a>
    <p><a style="text-decoration: none" href="{% url 'perfil' comentario.autor.perfil.pk %}"
        >@{{comentario.autor }} </a> {{ comentario.criado_em }} </p>

    {% if request.user == comentario.autor %}
        <a href="{% url 'comentario-delete' post.pk comentario.pk %}" style="color: #333;">Deletar</a>
    {% endif %}
</p>

<p>{{ comentario.comentario }}</p>

<form method="POST" action="{% url 'comentario-like' post.pk comentario.pk %}">
    {% csrf_token %}
    <input type="hidden" name="next" value="{{ request.path }}">
    <button type="submit">Amei
        <span> {{ comentario.likes.all.count }} </span>
    </button>
</form>



{% endfor %}

{% endblock content %}